(this["webpackJsonpmidi-chords"]=this["webpackJsonpmidi-chords"]||[]).push([[0],{12:function(e,t,i){e.exports=i(23)},17:function(e,t,i){},23:function(e,t,i){"use strict";i.r(t);var n=i(0),a=i.n(n),s=i(8),o=i.n(s),r=(i(17),i(25)),c=i(11),h=i(2),l=i(3);class m extends n.PureComponent{constructor(e,t={top:0,right:0,bottom:0,left:0},i=1,n=1,s=!0,o=!0){super(e),this.onResize=()=>{},this.increaseRows=()=>{const e=this.state,t=e.rowSpan,i=e.rowlimit,n=e.margin,a=e.canResizeRows,s=this.props.viewSize.outerHeight;if(!a)return;if(t>=i)return;const o=t+1,r=s*o;this.setState({rowSpan:o,viewHeight:r,height:r-n.top-n.bottom},this.onResize)},this.decreaseRows=()=>{const e=this.state,t=e.rowSpan,i=e.margin,n=e.canResizeRows,a=this.props.viewSize.outerHeight;if(!n)return;if(t<=1)return;const s=t-1,o=a*s;this.setState({rowSpan:s,viewHeight:o,height:o-i.top-i.bottom},this.onResize)},this.increaseColumns=()=>{const e=this.state,t=e.columnSpan,i=e.columnLimit,n=e.margin,a=e.canResizeColumns,s=this.props.viewSize.outerWidth;if(!a)return;if(t>=i)return;const o=t+1,r=s*o;this.setState({columnSpan:o,viewWidth:r,width:r-n.left-n.right},this.onResize)},this.decreaseColumns=()=>{const e=this.state,t=e.columnSpan,i=e.margin,n=e.canResizeColumns,a=this.props.viewSize.outerWidth;if(!n)return;if(t<=1)return;const s=t-1,o=a*s;this.setState({columnSpan:s,viewWidth:o,width:o-i.left-i.right},this.onResize)},this.close=()=>{const e=this.props,t=e.toggleView,i=e.name;t&&i&&t(i)},this.getSizeControlHTML=()=>a.a.createElement("div",{className:"sizeControl"},this.state.canResizeRows&&a.a.createElement("span",null,a.a.createElement("button",{onClick:this.increaseRows,title:"Increase rows",disabled:this.state.rowSpan>=this.state.rowlimit},a.a.createElement(h.a,{icon:l.b})),a.a.createElement("button",{onClick:this.decreaseRows,title:"Decrease rows",disabled:this.state.rowSpan<=1},a.a.createElement(h.a,{icon:l.e}))),this.state.canResizeColumns&&a.a.createElement("span",null,a.a.createElement("button",{onClick:this.increaseColumns,title:"Increase columns",disabled:this.state.columnSpan>=this.state.columnLimit},a.a.createElement(h.a,{icon:l.a})),a.a.createElement("button",{onClick:this.decreaseColumns,title:"Decrease columns",disabled:this.state.columnSpan<=1},a.a.createElement(h.a,{icon:l.d}))),a.a.createElement("button",{onClick:this.close,title:"Close"},a.a.createElement(h.a,{icon:l.f})));const r=e.viewSize,c=r.outerWidth,m=r.outerHeight,d=c*n,u=m*i;this.state={rowSpan:i,columnSpan:n,canResizeRows:s,canResizeColumns:o,rowlimit:12,columnLimit:2,outerWidth:c,outerHeight:m,viewHeight:u,viewWidth:d,margin:t,width:c*n-t.left-t.right,height:m*i-t.top-t.bottom}}resizeComponent(e={}){const t=this.props.viewSize,i=t.outerWidth,n=t.outerHeight,a=this.state,s=a.outerWidth,o=a.outerHeight,r=a.margin,h=a.rowSpan,l=a.columnSpan;if(s!==i||o!==n){const t=i*l,a=n*h;this.setState(Object(c.a)({},e,{outerWidth:i,outerHeight:n,viewWidth:t,viewHeight:a,width:i*l-r.left-r.right,height:n*h-r.top-r.bottom}),this.onResize)}}}var d=i(4);class u extends m{constructor(e){super(e,{top:20,right:20,bottom:40,left:20},1,1,!1,!1),this.componentDidUpdate=()=>this.resizeComponent()}render(){const e=this.state,t=e.rowSpan,i=e.columnSpan,n=e.viewWidth,s=e.viewHeight,o=e.width,c=e.height,h=e.margin,l=this.props.currentNotes,m=d.Piano.pianoPitchRange.get(88),u=m.minPitch,p=m.maxPitch,g=o/Object(r.a)(u,p+1).filter(e=>!d.Midi.isSharp(e)).length,w=.9*g,v=[],f=[],S=[],E=[];let z=0;for(let r=-1;r<11;r++)for(let e=0;e<12;e++){const t=12*r+e;if(t<u||t>p)continue;const i=d.Midi.isSharp(t),n=d.Midi.getMidiNoteByNr(t),s=i?z-.5*w:z;let o=i?0:.02*c;const h=i?w:g,m=i?.6*c:.98*c;t%12===0&&E.push({octave:r,x:s});let b="#f8f8f8",C="#111",R=5;l.has(t)?b="steelblue":(b=i?"#222":"#f8f8f8",C=i?"#eee":"#222");const N=a.a.createElement("rect",{key:t,width:h,height:m,x:s,y:o,rx:R,ry:R,fill:b,stroke:"#888",strokeWidth:"0.5"},a.a.createElement("title",null,n.label," (MIDI ",t,")"));S.push(a.a.createElement("text",{key:t,fontSize:"10px",style:{fill:C,textAnchor:"middle",alignmentBaseline:"baseline",writingMode:"vertical-lr",textOrientation:"upright"},x:s+.5*h,y:i?m-18:m-10},n.name)),i?f.push(N):(v.push(N),z+=g)}const b=[],C=[],R=c+15;for(let r=0;r<E.length-1;r++){const e=E[r].x+2,t=E[r+1].x-2,i="\n                M ".concat(e," ").concat(R-10,"\n                L ").concat(e," ").concat(R,"\n                L ").concat(t," ").concat(R,"\n                L ").concat(t," ").concat(R-10,"\n            ");b.push(a.a.createElement("path",{key:i,fill:"none",stroke:"#888",d:i})),C.push(a.a.createElement("text",{key:i,textAnchor:"middle",x:(e+t)/2,y:R+12},"Octave ",E[r].octave-1))}return a.a.createElement("div",{className:"View PianoKeyboard",style:{gridArea:"span ".concat(t," / span ").concat(i)}},a.a.createElement("svg",{width:n,height:s},a.a.createElement("g",{ref:e=>this.svg=e,transform:"translate(".concat(h.left,", ").concat(h.top,")")},v,f,S,b,C)))}}var p=i(10),g=i(9);class w extends n.Component{constructor(e){super(e),this.onResize=()=>{const e=Math.floor(window.innerWidth-10);this.setState({viewSize:{outerWidth:e,outerHeight:Math.floor(Math.min(e/4,window.innerHeight-200))}})},this.getMidiLiveData=()=>this.state.midiLiveData,this.setMidiLiveData=e=>{this.state.midiLiveData=e,this.setState({midiLiveData:e})},this.addCurrentNote=e=>{const t=new Map(this.state.currentNotes);t.set(e.pitch,e),this.setState({currentNotes:t})},this.removeCurrentNote=e=>{const t=new Map(this.state.currentNotes);t.delete(e),this.setState({currentNotes:t})},new d.MidiInputManager(this.getMidiLiveData,this.setMidiLiveData,this.addCurrentNote,this.removeCurrentNote),this.state={viewSize:{outerWidth:800,outerHeight:600},midiLiveData:[],currentNotes:new Map}}componentDidMount(){window.addEventListener("resize",this.onResize,!1),this.onResize()}getChordName(e){const t=e.map(e=>e.getLetter());return p.a.detect(t)}render(){const e=this.state,t=Array.from(e.currentNotes.values()).sort((e,t)=>e.pitch-t.pitch),i=this.getChordName(t);return console.log(i),a.a.createElement("div",{className:"App dark"},a.a.createElement("div",{className:"chordInfo"},a.a.createElement("div",null,Array.from(t).map(e=>e.getName()).join(" ")),a.a.createElement("div",null,"Chord name: ",i.join(", "))),a.a.createElement("div",{className:"explanation"},a.a.createElement("span",null,a.a.createElement(h.a,{icon:l.c}),"\xa0 Connect a MIDI device and play some notes to see the chord type.")),a.a.createElement(u,{name:"Piano Keyboard",viewSize:e.viewSize,theme:"dark",currentNotes:e.currentNotes}),a.a.createElement("div",{className:"githubLink"},a.a.createElement("p",null,a.a.createElement("a",{href:"https://github.com/fheyen/midi-chords"},a.a.createElement(h.a,{icon:g.a}),"\xa0 https://github.com/fheyen/midi-chords")),a.a.createElement("p",null,"Using\xa0",a.a.createElement("a",{href:"https://github.com/tonaljs/tonal/tree/master/packages/chord-detect"},"tonaljs"),".")))}}o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(w,null)),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.b5f54075.chunk.js.map