(this["webpackJsonpmidi-chords"]=this["webpackJsonpmidi-chords"]||[]).push([[0],{18:function(t,e,i){},24:function(t,e,i){"use strict";i.r(e);var s=i(0),n=i(2),o=i.n(n),r=i(9),h=i.n(r),c=(i(18),i(26)),a=i(3),d=i(4);class l extends n.PureComponent{constructor(t,e={top:0,right:0,bottom:0,left:0},i=1,n=1,o=!0,r=!0){super(t),this.onResize=()=>{},this.increaseRows=()=>{const{rowSpan:t,rowlimit:e,margin:i,canResizeRows:s}=this.state,{outerHeight:n}=this.props.viewSize;if(!s)return;if(t>=e)return;const o=t+1,r=n*o;this.setState({rowSpan:o,viewHeight:r,height:r-i.top-i.bottom},this.onResize)},this.decreaseRows=()=>{const{rowSpan:t,margin:e,canResizeRows:i}=this.state,{outerHeight:s}=this.props.viewSize;if(!i)return;if(t<=1)return;const n=t-1,o=s*n;this.setState({rowSpan:n,viewHeight:o,height:o-e.top-e.bottom},this.onResize)},this.increaseColumns=()=>{const{columnSpan:t,columnLimit:e,margin:i,canResizeColumns:s}=this.state,{outerWidth:n}=this.props.viewSize;if(!s)return;if(t>=e)return;const o=t+1,r=n*o;this.setState({columnSpan:o,viewWidth:r,width:r-i.left-i.right},this.onResize)},this.decreaseColumns=()=>{const{columnSpan:t,margin:e,canResizeColumns:i}=this.state,{outerWidth:s}=this.props.viewSize;if(!i)return;if(t<=1)return;const n=t-1,o=s*n;this.setState({columnSpan:n,viewWidth:o,width:o-e.left-e.right},this.onResize)},this.close=()=>{const{toggleView:t,name:e}=this.props;t&&e&&t(e)},this.getSizeControlHTML=()=>Object(s.jsxs)("div",{className:"sizeControl",children:[this.state.canResizeRows&&Object(s.jsxs)("span",{children:[Object(s.jsx)("button",{onClick:this.increaseRows,title:"Increase rows",disabled:this.state.rowSpan>=this.state.rowlimit,children:Object(s.jsx)(a.a,{icon:d.b})}),Object(s.jsx)("button",{onClick:this.decreaseRows,title:"Decrease rows",disabled:this.state.rowSpan<=1,children:Object(s.jsx)(a.a,{icon:d.e})})]}),this.state.canResizeColumns&&Object(s.jsxs)("span",{children:[Object(s.jsx)("button",{onClick:this.increaseColumns,title:"Increase columns",disabled:this.state.columnSpan>=this.state.columnLimit,children:Object(s.jsx)(a.a,{icon:d.a})}),Object(s.jsx)("button",{onClick:this.decreaseColumns,title:"Decrease columns",disabled:this.state.columnSpan<=1,children:Object(s.jsx)(a.a,{icon:d.d})})]}),Object(s.jsx)("button",{onClick:this.close,title:"Close",children:Object(s.jsx)(a.a,{icon:d.f})})]});const{outerWidth:h,outerHeight:c}=t.viewSize,l=h*n,u=c*i;this.state={rowSpan:i,columnSpan:n,canResizeRows:o,canResizeColumns:r,rowlimit:12,columnLimit:2,outerWidth:h,outerHeight:c,viewHeight:u,viewWidth:l,margin:e,width:h*n-e.left-e.right,height:c*i-e.top-e.bottom}}resizeComponent(t={}){const{outerWidth:e,outerHeight:i}=this.props.viewSize,{outerWidth:s,outerHeight:n,margin:o,rowSpan:r,columnSpan:h}=this.state;if(s!==e||n!==i){const s=e*h,n=i*r;this.setState({...t,outerWidth:e,outerHeight:i,viewWidth:s,viewHeight:n,width:e*h-o.left-o.right,height:i*r-o.top-o.bottom},this.onResize)}}}var u=i(5);class p extends l{constructor(t){super(t,{top:20,right:20,bottom:40,left:20},1,1,!1,!1),this.componentDidUpdate=()=>this.resizeComponent()}render(){const{rowSpan:t,columnSpan:e,viewWidth:i,viewHeight:n,width:o,height:r,margin:h}=this.state,{currentNotes:a}=this.props,{minPitch:d,maxPitch:l}=u.Piano.pianoPitchRange.get(88),p=o/Object(c.a)(d,l+1).filter((t=>!u.Midi.isSharp(t))).length,m=.9*p,j=[],b=[],g=[],w=[];let x=0;for(let c=-1;c<11;c++)for(let t=0;t<12;t++){const e=12*c+t;if(e<d||e>l)continue;const i=u.Midi.isSharp(e),n=u.Midi.getMidiNoteByNr(e),o=i?x-.5*m:x;let h=i?0:.02*r;const v=i?m:p,f=i?.6*r:.98*r;e%12===0&&w.push({octave:c,x:o});let S="#f8f8f8",O="#111",z=5;a.has(e)?S="steelblue":(S=i?"#222":"#f8f8f8",O=i?"#eee":"#222");const C=Object(s.jsx)("rect",{width:v,height:f,x:o,y:h,rx:z,ry:z,fill:S,stroke:"#888",strokeWidth:"0.5",children:Object(s.jsxs)("title",{children:[n.label," (MIDI ",e,")"]})},e);g.push(Object(s.jsx)("text",{fontSize:"10px",style:{fill:O,textAnchor:"middle",alignmentBaseline:"baseline",writingMode:"vertical-lr",textOrientation:"upright"},x:o+.5*v,y:i?f-18:f-10,children:n.name},e)),i?b.push(C):(j.push(C),x+=p)}const v=[],f=[],S=r+15;for(let c=0;c<w.length-1;c++){const t=w[c].x+2,e=w[c+1].x-2,i=`\n                M ${t} ${S-10}\n                L ${t} ${S}\n                L ${e} ${S}\n                L ${e} ${S-10}\n            `;v.push(Object(s.jsx)("path",{fill:"none",stroke:"#888",d:i},i)),f.push(Object(s.jsxs)("text",{textAnchor:"middle",x:(t+e)/2,y:S+12,children:["Octave ",w[c].octave-1]},i))}return Object(s.jsx)("div",{className:"View PianoKeyboard",style:{gridArea:`span ${t} / span ${e}`},children:Object(s.jsx)("svg",{width:i,height:n,children:Object(s.jsxs)("g",{ref:t=>this.svg=t,transform:`translate(${h.left}, ${h.top})`,children:[j,b,g,v,f]})})})}}var m=i(11),j=i(10);class b extends n.Component{constructor(t){super(t),this.onResize=()=>{const t=Math.floor(window.innerWidth-10);this.setState({viewSize:{outerWidth:t,outerHeight:Math.floor(Math.min(t/4,window.innerHeight-200))}})},this.getMidiLiveData=()=>this.state.midiLiveData,this.setMidiLiveData=t=>{this.state.midiLiveData=t,this.setState({midiLiveData:t})},this.addCurrentNote=t=>{const e=new Map(this.state.currentNotes);e.set(t.pitch,t),this.setState({currentNotes:e})},this.removeCurrentNote=t=>{const e=new Map(this.state.currentNotes);e.delete(t),this.setState({currentNotes:e})},new u.MidiInputManager(this.getMidiLiveData,this.setMidiLiveData,this.addCurrentNote,this.removeCurrentNote),this.state={viewSize:{outerWidth:800,outerHeight:600},midiLiveData:[],currentNotes:new Map}}componentDidMount(){window.addEventListener("resize",this.onResize,!1),this.onResize()}getChordName(t){const e=t.map((t=>t.getLetter()));return m.a.detect(e)}render(){const t=this.state,e=Array.from(t.currentNotes.values()).sort(((t,e)=>t.pitch-e.pitch)),i=this.getChordName(e);return console.log(i),Object(s.jsxs)("div",{className:"App dark",children:[Object(s.jsxs)("div",{className:"chordInfo",children:[Object(s.jsx)("div",{children:Array.from(e).map((t=>t.getName())).join(" ")}),Object(s.jsxs)("div",{children:["Chord name: ",i.join(", ")]})]}),Object(s.jsx)("div",{className:"explanation",children:Object(s.jsxs)("span",{children:[Object(s.jsx)(a.a,{icon:d.c}),"\xa0 Connect a MIDI device and play some notes to see the chord type."]})}),Object(s.jsx)(p,{name:"Piano Keyboard",viewSize:t.viewSize,theme:"dark",currentNotes:t.currentNotes}),Object(s.jsxs)("div",{className:"githubLink",children:[Object(s.jsx)("p",{children:Object(s.jsxs)("a",{href:"https://github.com/fheyen/midi-chords",children:[Object(s.jsx)(a.a,{icon:j.a}),"\xa0 https://github.com/fheyen/midi-chords"]})}),Object(s.jsxs)("p",{children:["Using\xa0",Object(s.jsx)("a",{href:"https://github.com/tonaljs/tonal/tree/master/packages/chord-detect",children:"tonaljs"}),"."]})]})]})}}h.a.render(Object(s.jsx)(o.a.StrictMode,{children:Object(s.jsx)(b,{})}),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.f3167b7d.chunk.js.map